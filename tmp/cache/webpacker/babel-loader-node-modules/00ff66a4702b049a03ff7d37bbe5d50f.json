{"ast":null,"code":"var _jsxFileName = \"/Users/eduardo/code/easalazarmiran/ like_machine/app/javascript/components/LikeButton.js\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport React, { Component } from 'react';\n\nvar LikeButton =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(LikeButton, _Component);\n\n  function LikeButton(props) {\n    var _this;\n\n    _classCallCheck(this, LikeButton);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(LikeButton).call(this, props));\n    _this.state = {\n      like_count: 0,\n      liked_by_user: false,\n      link_id: props.link_id\n    };\n    return _this;\n  }\n\n  _createClass(LikeButton, [{\n    key: \"handleLike\",\n    value: function handleLike() {\n      console.log('here');\n      var options = {\n        link_id: this.state.link_id,\n        url: 'http://localhost:3000/likes',\n        method: 'POST'\n      };\n\n      if (this.state.liked_by_user) {\n        options.url = \"http://localhost:3000/likes/\".concat(this.state.link_id);\n        options.method = 'DELETE';\n      }\n\n      this.callLikeEndpoint(options);\n    }\n  }, {\n    key: \"callLikeEndpoint\",\n    value: function callLikeEndpoint(options) {\n      var _this2 = this;\n\n      console.log(options);\n      fetch(options.url, {\n        method: options.method,\n        body: {\n          link_id: options.link_id\n        },\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      }).then(function (response) {\n        console.log(response);\n        if (response.ok) return response.json();\n      }).then(function (json) {\n        _this2.updateLike();\n      });\n    }\n  }, {\n    key: \"updateLike\",\n    value: function updateLike() {\n      this.setState(function (prevState) {\n        if (prevState.liked_by_user) {\n          return {\n            like_count: prevState.like_count - 1,\n            liked_by_user: false\n          };\n        } else {\n          return {\n            like_count: prevState.like_count + 1,\n            liked_by_user: true\n          };\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        onClick: this.handleLike.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56\n        },\n        __self: this\n      }, \"X\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      }, this.state.like_count, \" likes\"));\n    }\n  }]);\n\n  return LikeButton;\n}(Component);\n\nexport default LikeButton;","map":{"version":3,"sources":["/Users/eduardo/code/easalazarmiran/ like_machine/app/javascript/components/LikeButton.js"],"names":["React","Component","LikeButton","props","state","like_count","liked_by_user","link_id","console","log","options","url","method","callLikeEndpoint","fetch","body","headers","then","response","ok","json","updateLike","setState","prevState","handleLike","bind"],"mappings":";;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;IAEMC,U;;;;;AAEJ,sBAAYC,KAAZ,EAAkB;AAAA;;AAAA;;AAChB,oFAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AAACC,MAAAA,UAAU,EAAE,CAAb;AAAgBC,MAAAA,aAAa,EAAE,KAA/B;AAAsCC,MAAAA,OAAO,EAAEJ,KAAK,CAACI;AAArD,KAAb;AAFgB;AAGjB;;;;iCAEW;AACVC,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACA,UAAIC,OAAO,GAAG;AACZH,QAAAA,OAAO,EAAE,KAAKH,KAAL,CAAWG,OADR;AAEZI,QAAAA,GAAG,EAAE,6BAFO;AAGZC,QAAAA,MAAM,EAAE;AAHI,OAAd;;AAMA,UAAG,KAAKR,KAAL,CAAWE,aAAd,EAA6B;AAC3BI,QAAAA,OAAO,CAACC,GAAR,yCAA6C,KAAKP,KAAL,CAAWG,OAAxD;AACAG,QAAAA,OAAO,CAACE,MAAR,GAAiB,QAAjB;AACD;;AAED,WAAKC,gBAAL,CAAsBH,OAAtB;AACD;;;qCAGgBA,O,EAAQ;AAAA;;AACvBF,MAAAA,OAAO,CAACC,GAAR,CAAYC,OAAZ;AACAI,MAAAA,KAAK,CAACJ,OAAO,CAACC,GAAT,EAAc;AACjBC,QAAAA,MAAM,EAAEF,OAAO,CAACE,MADC;AAEjBG,QAAAA,IAAI,EAAE;AAAER,UAAAA,OAAO,EAAEG,OAAO,CAACH;AAAnB,SAFW;AAGjBS,QAAAA,OAAO,EAAE;AAAC,0BAAgB;AAAjB;AAHQ,OAAd,CAAL,CAKGC,IALH,CAKQ,UAACC,QAAD,EAAc;AAClBV,QAAAA,OAAO,CAACC,GAAR,CAAYS,QAAZ;AACA,YAAGA,QAAQ,CAACC,EAAZ,EAAgB,OAAOD,QAAQ,CAACE,IAAT,EAAP;AACjB,OARH,EASGH,IATH,CASQ,UAACG,IAAD,EAAS;AACb,QAAA,MAAI,CAACC,UAAL;AACD,OAXH;AAYD;;;iCAEW;AACV,WAAKC,QAAL,CAAc,UAACC,SAAD,EAAc;AAC1B,YAAGA,SAAS,CAACjB,aAAb,EAA2B;AACzB,iBAAO;AAACD,YAAAA,UAAU,EAAGkB,SAAS,CAAClB,UAAV,GAAuB,CAArC;AAAyCC,YAAAA,aAAa,EAAE;AAAxD,WAAP;AACD,SAFD,MAEK;AACH,iBAAO;AAACD,YAAAA,UAAU,EAAGkB,SAAS,CAAClB,UAAV,GAAuB,CAArC;AAAyCC,YAAAA,aAAa,EAAE;AAAxD,WAAP;AACD;AACF,OAND;AAOD;;;6BAEO;AACN,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAG,QAAA,OAAO,EAAE,KAAKkB,UAAL,CAAgBC,IAAhB,CAAqB,IAArB,CAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAI,KAAKrB,KAAL,CAAWC,UAAf,WAFF,CADF;AAMD;;;;EAzDsBJ,S;;AA6DzB,eAAeC,UAAf","sourcesContent":["import React, { Component } from 'react';\n\nclass LikeButton extends Component {\n\n  constructor(props){\n    super(props);\n    this.state = {like_count: 0, liked_by_user: false, link_id: props.link_id}\n  }\n\n  handleLike(){\n    console.log('here')\n    let options = {\n      link_id: this.state.link_id,\n      url: 'http://localhost:3000/likes',\n      method: 'POST'\n    }\n\n    if(this.state.liked_by_user) {\n      options.url = `http://localhost:3000/likes/${this.state.link_id}`\n      options.method = 'DELETE'\n    }\n\n    this.callLikeEndpoint(options);\n  }\n\n\n  callLikeEndpoint(options){\n    console.log(options)\n    fetch(options.url, {\n      method: options.method,\n      body: { link_id: options.link_id },\n      headers: {'Content-Type': 'application/json'}\n    })\n      .then((response) => {\n        console.log(response)\n        if(response.ok) return response.json();\n      })\n      .then((json)=> {\n        this.updateLike()\n      })\n  }\n\n  updateLike(){\n    this.setState((prevState)=> {\n      if(prevState.liked_by_user){\n        return {like_count: (prevState.like_count - 1), liked_by_user: false }\n      }else{\n        return {like_count: (prevState.like_count + 1), liked_by_user: true }\n      }\n    })\n  }\n\n  render(){\n    return(\n      <div>\n        <p onClick={this.handleLike.bind(this)}>X</p>\n        <p>{this.state.like_count} likes</p>\n      </div>\n      )\n  }\n\n}\n\nexport default LikeButton;\n"]},"metadata":{},"sourceType":"module"}